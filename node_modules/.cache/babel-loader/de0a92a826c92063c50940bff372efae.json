{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/taehyungkim/Desktop/self-study/project_picdiary_deploy/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _toConsumableArray from\"/Users/taehyungkim/Desktop/self-study/project_picdiary_deploy/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/taehyungkim/Desktop/self-study/project_picdiary_deploy/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject,_templateObject2,_templateObject3;import React,{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import styled from\"styled-components\";import PicAdd from\"../UI_components/PicAdd\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AddByDate=function AddByDate(_ref){var picData=_ref.picData,setPicData=_ref.setPicData,setIsPending=_ref.setIsPending,rawCategoryData=_ref.rawCategoryData,categories=_ref.categories,setRawCategoryData=_ref.setRawCategoryData,setCategories=_ref.setCategories,isChanged=_ref.isChanged,setIsChanged=_ref.setIsChanged;var _useParams=useParams(),date=_useParams.date;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),newPicData=_useState2[0],setNewPicData=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];// const [data, setData] = useState(null);\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),options=_useState6[0],setOptions=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),rawData=_useState8[0],setRawData=_useState8[1];// const [isChanged, setIsChanged] = useState(false);\nuseEffect(function(){fetch(\"http://localhost:3001/categories/\").then(function(res){if(!res.ok){throw Error(\"could not fetch the data for that resource\");}return res.json();}).then(function(data){console.log(data,\"data\");setRawCategoryData(data);setCategories(data.map(function(el){return el.category;}));});},[]);useEffect(function(){setIsPending(true);fetch(\"http://localhost:3001/diary/?date=\".concat(date)).then(function(res){if(!res.ok){throw Error(\"could not fetch the data for that resource\");}return res.json();}).then(function(data){setNewPicData(data[0].content);setTitle(data[0].title);setIsPending(false);setRawData(data);});setOptions([\"---\"].concat(_toConsumableArray(categories)));},[categories]);var Add_container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    width: 390px;\\n    height: 100%;\\n    display: flex;\\n    flex-direction: column;\\n  \"])));var Info_container=styled.form(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    height: 76px;\\n    background-color: #f4eee2;\\n    margin-bottom: 20px;\\n    display: flex;\\n\\n    > .info_wrapper {\\n      flex-grow: 5;\\n      display: flex;\\n      flex-direction: column;\\n      justify-content: space-around;\\n      align-items: stretch;\\n    }\\n    > .icon_wrapper {\\n      flex-grow: 1;\\n      display: flex;\\n      justify-content: center;\\n      align-items: center;\\n    }\\n  \"])));var Picadd_wrapper=styled.section(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    display: flex;\\n    flex-direction: column;\\n    align-items: center;\\n  \"])));var handleSubmit=function handleSubmit(e){var getRandomNumber=function getRandomNumber(min,max){return parseInt(Math.random()*(Number(max)-Number(min)+2));};fetch(\"http://localhost:3001/diary/\".concat(rawData[0].id),{method:\"PATCH\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({content:[].concat(_toConsumableArray(rawData[0].content),[{date_id:\"\".concat(rawData[0].content.length),picture:\"https://picsum.photos/id/\".concat(getRandomNumber(1,98),\"/300/300\"),text:\"\"}])})});// setData(\n//   (data.content[data.content.length] = {\n//     date_id: data.content.length,\n//     picture: `https://picsum.photos/id/${getRandomNumber(1, 98)}/300/300`,\n//     text: \"\",\n//   })\n// );\n};// useEffect(() => {\n//   setNewPicData(\n//     ...picData.filter((el) => el.date === date).map((el) => el.content)\n//   );\n//   setData(...picData.filter((el) => el.date === date));\n//   setTitle(...picData.filter((el) => el.date === date).map((el) => el.title));\n//   picData.forEach((el) => {\n//     el.content.forEach((content) => {\n//       console.log(content.category);\n//       if (\n//         !options.includes(content.category) &&\n//         content.category !== undefined\n//       ) {\n//         options.push(content.category);\n//       }\n//     });\n//   });\n//   setOptions(options);\n// }, []);\n// useEffect(() => {\n//   setNewPicData(\n//     ...picData.filter((el) => el.date === date).map((el) => el.content)\n//   );\n// }, [picData]);\n// useEffect(() => {\n//   setNewPicData(\n//     ...picData.filter((el) => el.date === date).map((el) => el.content)\n//   );\n//   setData(...picData.filter((el) => el.date === date));\n// }, [data]);\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Add_container,{children:[/*#__PURE__*/_jsxs(Info_container,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info_wrapper\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"\\uB0A0\\uC9DC :\",/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:date,readOnly:\"true\"})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"\\uC81C\\uBAA9 :\",/*#__PURE__*/_jsx(\"input\",{value:title,readOnly:\"true\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"icon_wrapper\",children:/*#__PURE__*/_jsx(\"button\",{children:\"\\uC0AC\\uC9C4\\uCD94\\uAC00\"})})]}),/*#__PURE__*/_jsx(Picadd_wrapper,{children:newPicData.map(function(el){return/*#__PURE__*/_jsx(PicAdd,{date:date,data:el,picture:el.picture,content:el.picture,picData:picData,setPicData:setPicData,options:options,newPicData:newPicData,rawData:rawData,isChanged:isChanged,setIsChanged:setIsChanged},el.id);})})]})});};export default AddByDate;","map":{"version":3,"names":["React","useEffect","useState","useParams","styled","PicAdd","AddByDate","picData","setPicData","setIsPending","rawCategoryData","categories","setRawCategoryData","setCategories","isChanged","setIsChanged","date","newPicData","setNewPicData","title","setTitle","options","setOptions","rawData","setRawData","fetch","then","res","ok","Error","json","data","console","log","map","el","category","content","Add_container","div","Info_container","form","Picadd_wrapper","section","handleSubmit","e","getRandomNumber","min","max","parseInt","Math","random","Number","id","method","headers","body","JSON","stringify","date_id","length","picture","text"],"sources":["/Users/taehyungkim/Desktop/self-study/project_picdiary_deploy/src/components/AddByDate.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport PicAdd from \"../UI_components/PicAdd\";\n\nconst AddByDate = ({\n  picData,\n  setPicData,\n  setIsPending,\n  rawCategoryData,\n  categories,\n  setRawCategoryData,\n  setCategories,\n  isChanged,\n  setIsChanged,\n}) => {\n  const { date } = useParams();\n  const [newPicData, setNewPicData] = useState([]);\n  const [title, setTitle] = useState(\"\");\n  // const [data, setData] = useState(null);\n  const [options, setOptions] = useState([]);\n  const [rawData, setRawData] = useState(null);\n  // const [isChanged, setIsChanged] = useState(false);\n  useEffect(() => {\n    fetch(\"http://localhost:3001/categories/\")\n      .then((res) => {\n        if (!res.ok) {\n          throw Error(\"could not fetch the data for that resource\");\n        }\n        return res.json();\n      })\n      .then((data) => {\n        console.log(data, \"data\");\n        setRawCategoryData(data);\n        setCategories(data.map((el) => el.category));\n      });\n  }, []);\n\n  useEffect(() => {\n    setIsPending(true);\n    fetch(`http://localhost:3001/diary/?date=${date}`)\n      .then((res) => {\n        if (!res.ok) {\n          throw Error(\"could not fetch the data for that resource\");\n        }\n        return res.json();\n      })\n      .then((data) => {\n        setNewPicData(data[0].content);\n        setTitle(data[0].title);\n        setIsPending(false);\n        setRawData(data);\n      });\n    setOptions([\"---\", ...categories]);\n  }, [categories]);\n\n  const Add_container = styled.div`\n    width: 390px;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n  `;\n  const Info_container = styled.form`\n    height: 76px;\n    background-color: #f4eee2;\n    margin-bottom: 20px;\n    display: flex;\n\n    > .info_wrapper {\n      flex-grow: 5;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-around;\n      align-items: stretch;\n    }\n    > .icon_wrapper {\n      flex-grow: 1;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n  `;\n  const Picadd_wrapper = styled.section`\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  `;\n\n  const handleSubmit = (e) => {\n    const getRandomNumber = (min, max) => {\n      return parseInt(Math.random() * (Number(max) - Number(min) + 2));\n    };\n    fetch(`http://localhost:3001/diary/${rawData[0].id}`, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        content: [\n          ...rawData[0].content,\n          {\n            date_id: `${rawData[0].content.length}`,\n            picture: `https://picsum.photos/id/${getRandomNumber(\n              1,\n              98\n            )}/300/300`,\n            text: \"\",\n          },\n        ],\n      }),\n    });\n    // setData(\n    //   (data.content[data.content.length] = {\n    //     date_id: data.content.length,\n    //     picture: `https://picsum.photos/id/${getRandomNumber(1, 98)}/300/300`,\n    //     text: \"\",\n    //   })\n    // );\n  };\n  // useEffect(() => {\n  //   setNewPicData(\n  //     ...picData.filter((el) => el.date === date).map((el) => el.content)\n  //   );\n  //   setData(...picData.filter((el) => el.date === date));\n  //   setTitle(...picData.filter((el) => el.date === date).map((el) => el.title));\n  //   picData.forEach((el) => {\n  //     el.content.forEach((content) => {\n  //       console.log(content.category);\n  //       if (\n  //         !options.includes(content.category) &&\n  //         content.category !== undefined\n  //       ) {\n  //         options.push(content.category);\n  //       }\n  //     });\n  //   });\n  //   setOptions(options);\n  // }, []);\n\n  // useEffect(() => {\n  //   setNewPicData(\n  //     ...picData.filter((el) => el.date === date).map((el) => el.content)\n  //   );\n  // }, [picData]);\n\n  // useEffect(() => {\n  //   setNewPicData(\n  //     ...picData.filter((el) => el.date === date).map((el) => el.content)\n  //   );\n  //   setData(...picData.filter((el) => el.date === date));\n  // }, [data]);\n\n  return (\n    <>\n      <Add_container>\n        <Info_container onSubmit={handleSubmit}>\n          <div className=\"info_wrapper\">\n            <label>\n              날짜 :<input type=\"date\" value={date} readOnly=\"true\"></input>\n            </label>\n            <label>\n              제목 :<input value={title} readOnly=\"true\"></input>\n            </label>\n          </div>\n          <div className=\"icon_wrapper\">\n            <button>사진추가</button>\n          </div>\n        </Info_container>\n        <Picadd_wrapper>\n          {newPicData.map((el) => {\n            return (\n              <PicAdd\n                key={el.id}\n                date={date}\n                data={el}\n                picture={el.picture}\n                content={el.picture}\n                picData={picData}\n                setPicData={setPicData}\n                options={options}\n                newPicData={newPicData}\n                rawData={rawData}\n                isChanged={isChanged}\n                setIsChanged={setIsChanged}\n              ></PicAdd>\n            );\n          })}\n        </Picadd_wrapper>\n      </Add_container>\n    </>\n  );\n};\n\nexport default AddByDate;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}